function toggleFullScreen(){document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():document.documentElement.requestFullscreen()}function prepareDoll(e){$(e).find("#bodyArea, #piecesArea > div, #bodyArea > img").css({"background-color":"transparent",border:"0","border-radius":"0"})}!function(e){e.fn.invisible=function(){return this.each(function(){this.style.cssText="visibility: hidden; display: block !important;"})},e.fn.visible=function(){return this.each(function(){this.style.cssText=""})}}(jQuery),$(function(){$("#piecesArea").find("img").draggable({stack:".ui-draggable",distance:0,containment:"document"}),$("#bodyArea").droppable({accept:".ui-draggable",tolerance:"touch",drop:function(e,t){t.draggable.addClass("draggedout")},out:function(e,t){t.draggable.removeClass("draggedout");var n=t.draggable.parent().index()-1;$("#piecesArea").tabs({active:n})}}),$("#piecesArea").tabs({activate:function(e,t){t.oldPanel.invisible(),t.newPanel.visible()}}),$("#instrBtn").on("click",function(){$("#instructions").slideToggle()}),$("#swatchesArea a").on("click",function(e){for(var t,n,a=$(this).attr("href"),o=$(this).parent().attr("id"),l=(n=(t=a).substr(t.lastIndexOf("/")+1)).substr(0,n.lastIndexOf(".")).replace(/\.[^/.]+$/,"").replace("-slash-","/").replace("``",'"').replace("`","'"),i=document.getElementsByClassName("switcher"),r=document.getElementsByClassName("clickable"),c=Array.from(i),s=Array.from(r),d=0;d<c.length;d++){let f=$(c[d]).attr("id"),u=$(s[d]);o===f&&$(u).attr({src:a,alt:l,title:l}),e.preventDefault()}}),$("#reset").on("click",function(){location.reload(!0),window.location.reload()});let e=document.getElementById("bodyArea"),t=e.offsetWidth,n=e.offsetHeight,a=e.offsetLeft,o=e.offsetTop;$("#downloadDoll").on("click",function(){html2canvas(document.querySelector("#dollmaker_container"),{onclone:function(e){prepareDoll(e)},backgroundColor:null,allowTaint:!0,useCORS:!0,width:t,height:n,scale:1,imageSmoothingEnabled:!1,x:a,y:o}).then(e=>{e.toBlob(function(t){try{window.saveAs(t,"my_doll.png",e.toDataURL("image/png"))}catch(n){alert(n)}})})});let l=document.querySelector("#avi-area"),i=l.offsetWidth,r=l.offsetHeight,c=a+l.offsetLeft,s=o+l.offsetTop;$("#downloadAvi").on("click",function(){html2canvas(document.querySelector("#dollmaker_container"),{onclone:function(e){prepareDoll(e)},backgroundColor:null,allowTaint:!0,width:i,height:r,x:c,y:s,scale:1,imageSmoothingEnabled:!1}).then(e=>{e.toBlob(function(t){try{window.saveAs(t,"my_doll_avi.png",e.toDataURL("image/png"))}catch(n){alert(n)}})})})});